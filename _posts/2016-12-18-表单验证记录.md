---  
layout: page  
title: 表单验证记录   
excerpt: "工作中遇到的各式各样表单验证"   
category: js    
tag: 2016   
---     
最近做了一个电商网站的管理系统，设计的注册界面有20多个字段需要输入，简直恐怖。其中涉及到很多字段的验证、以及文件上传等，在此做一个总结。    

*注:需要兼容到IE8，所以只使用了部分Html5的特性*

### 基础验证        
  **typeof** 可以判断的类型只有6种: string、number、boolean、undefined、object、function 。             

- 判断 null    
  ```
    Object.prototype.toString.call(null)      //返回结果  "[object Null]"
  ```     

- 判断 array    
  ```
    Object.prototype.toString.call([])   //返回结果   "[object Array]"
  ```      

- 判断 空        
  *input输入框的值默认是string类型。*         

  ```   
    //默认inputValue是输入框的值，且已经去掉空格.               
    var inputValue = "";   
    //方法一
    function isEmpty_1(value){      
      if(value != ""){      
        return true;       
      }      
      return false;        
    }    
    //方法二
    function isEmpty_2(value){      
      if(value.length > 0){      
        return true;       
      }      
      return false;        
    }    
    //调用方法      
    isEmpty_1(inputValue);   
    isEmpty_2(inputValue);    
  ```
- 原生JS的trim函数实现     
  *虽然在项目中使用的是JQuery提供的trim函数,但是还需要涉猎一下在原生JS中是如何实现的。*      
  [司徒正美 JavaScript trim函数大赏](http://www.cnblogs.com/rubylouvre/archive/2009/09/18/1568794.html)    

- 即时输入     
  *onkeydown、onkeypress、onkeyup、onchange都无法即时捕获输入框的值。*    

  oninput是HTML5的标准事件,在输入框内容被修改时触发,主流浏览器都已经支持。  

  针对IE9以下版本的浏览器，通过onpropertychange事件代替。    
  Onpropertychange事件，在旧版IE浏览器中的事件注册模式只支持attachEvent，从IE9开始支持W3C标准的"addEventListener"事件模型。     

  - **原生JS**      

  ```
    //html部分     
    <input type="text" oninput="OnInput(event)" onpropertychange="OnPropertyChange(event)" value="test">       
    //js部分   
    //oninput触发的函数     
    function OnInput(event){     
      //在这里写对应的执行语句     
    }    
    //onpropertychange触发的函数     
    function OnPropertyChange(event){     
      if (event.propertyName.toLowerCase () == "value") {     
        //在这里写对应的执行语句    
      }    
    }    
  ```    

  - **JQuery**    

  ```
    //html部分     fax表示传真     
    <input type="text" name="fax"  value="test">     
    //js部分     
    $("input[name='fax']").bind('input propertychange', function() {      
      //在这里写对应的执行语句      
    });   
  ```  

  *oninput和onpropertychange这两个事件在IE9中,通过右键菜单中的剪切和删除命令删除内容的时候不会触发*    
   
  **参考**:    
  [MDN oninput接口](https://developer.mozilla.org/zh-CN/docs/Web/API/GlobalEventHandlers/oninput)      
  [Microsoft  onpropertychange](https://msdn.microsoft.com/en-us/library/ms536956(v=vs.85).aspx)      
  [实时监听输入框值变化的完美方案：oninput & onpropertychange](http://www.cnblogs.com/lhb25/archive/2012/11/30/oninput-and-onpropertychange-event-for-input.html)    
  [总结oninput、onchange与onpropertychange事件的用法和区别](http://blog.csdn.net/freshlover/article/details/39050609)
